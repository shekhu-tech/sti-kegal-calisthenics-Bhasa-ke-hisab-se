<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, viewport-fit=cover">
    <title>S.T.I PRO | Calisthenics System</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700;800;900&family=JetBrains+Mono:wght@400;700&display=swap" rel="stylesheet">
    
    <style>
        :root {
            /* === ORANGE THEME VARIABLES (BODY) === */
            --bg-deep: #050200;
            --bg-card: rgba(20, 10, 5, 0.9);
            --bg-glass: rgba(255, 255, 255, 0.03);
            
            --theme-neon: #FF5500; /* Shining Dark Orange */
            --theme-dim: #993300;
            --theme-glow: 0 0 15px rgba(255, 85, 0, 0.4);
            
            --border-light: rgba(255, 255, 255, 0.1);
            --border-theme: rgba(255, 85, 0, 0.3);

            /* === GOLD THEME VARIABLES (HEADER ONLY) === */
            --header-gold: #FFD700;
            --header-glow: 0 0 15px rgba(255, 215, 0, 0.4);
        }

        body {
            font-family: 'Inter', sans-serif;
            background-color: var(--bg-deep);
            color: #ffffff;
            -webkit-font-smoothing: antialiased;
            overflow: hidden; 
            /* Orange Tinted Background */
            background-image: 
                radial-gradient(circle at 10% 20%, rgba(255, 85, 0, 0.05) 0%, transparent 20%),
                radial-gradient(circle at 90% 80%, rgba(204, 68, 0, 0.05) 0%, transparent 20%);
            height: 100dvh;
        }

        .font-mono-tech {
            font-family: 'JetBrains Mono', monospace;
        }

        /* === MAIN CONTAINER === */
        .glass-panel {
            background: var(--bg-card);
            backdrop-filter: blur(20px);
            -webkit-backdrop-filter: blur(20px);
            border: 1px solid var(--border-light);
            box-shadow: 0 20px 50px -12px rgba(0, 0, 0, 0.9);
            
            height: auto; 
            max-height: 85dvh; 
            width: 100%;
            max-width: 420px;
            
            display: flex;
            flex-direction: column;
            transition: height 0.3s ease;
        }

        /* Orange Border */
        .glass-panel-orange {
            border: 1px solid var(--border-theme);
            box-shadow: 0 0 30px -10px rgba(255, 85, 0, 0.2);
        }

        .text-glow {
            text-shadow: var(--theme-glow);
        }
        
        .header-glow {
            text-shadow: var(--header-glow);
        }
        
        /* Custom Scrollbar (Orange) */
        ::-webkit-scrollbar { width: 4px; }
        ::-webkit-scrollbar-track { background: transparent; }
        ::-webkit-scrollbar-thumb { background: rgba(255, 85, 0, 0.2); border-radius: 10px; }
        ::-webkit-scrollbar-thumb:hover { background: rgba(255, 85, 0, 0.5); }

        /* Buttons (Orange Theme) */
        .btn-tech {
            background: linear-gradient(145deg, rgba(255,255,255,0.05) 0%, rgba(255,255,255,0.01) 100%);
            border: 1px solid var(--border-light);
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
            position: relative;
            overflow: hidden;
        }
        
        .btn-tech::before {
            content: '';
            position: absolute;
            top: 0; left: -100%; width: 100%; height: 100%;
            background: linear-gradient(90deg, transparent, rgba(255, 85, 0, 0.1), transparent);
            transition: 0.5s;
        }

        .btn-tech:hover {
            border-color: var(--theme-neon);
            box-shadow: var(--theme-glow);
            transform: translateY(-2px);
        }
        
        .btn-tech:hover::before { left: 100%; }
        .btn-tech:active { transform: scale(0.98); }

        .btn-primary-glow {
            background: var(--theme-neon);
            color: #fff;
            font-weight: 800;
            box-shadow: 0 0 20px rgba(255, 85, 0, 0.4);
            transition: all 0.3s ease;
        }
        .btn-primary-glow:hover {
            background: #fff;
            color: #FF5500;
            box-shadow: 0 0 30px rgba(255, 85, 0, 0.6);
        }

        /* Exercise Cards (Orange Theme) */
        .exercise-card {
            background: linear-gradient(180deg, rgba(255,255,255,0.03) 0%, rgba(0,0,0,0.2) 100%);
            border: 1px solid var(--border-light);
            transition: all 0.3s ease;
            flex-shrink: 0; 
        }
        .exercise-card.current {
            border-color: var(--theme-neon);
            background: linear-gradient(180deg, rgba(255, 85, 0, 0.1) 0%, rgba(0,0,0,0.3) 100%);
            box-shadow: inset 0 0 20px rgba(255, 85, 0, 0.1);
        }
        .exercise-card.completed {
            border-color: #ffffff;
            opacity: 0.6;
        }
        .exercise-card.locked {
            opacity: 0.3;
            filter: grayscale(1);
        }

        .animate-fade-in { animation: fadeIn 0.5s ease-out forwards; }
        @keyframes fadeIn { from { opacity: 0; transform: translateY(10px); } to { opacity: 1; transform: translateY(0); } }

        .hud-box { position: relative; }
        .hud-box::after {
            content: ''; position: absolute; bottom: 0; right: 0;
            width: 10px; height: 10px;
            border-bottom: 2px solid var(--theme-neon);
            border-right: 2px solid var(--theme-neon);
        }
        .hud-box::before {
            content: ''; position: absolute; top: 0; left: 0;
            width: 10px; height: 10px;
            border-top: 2px solid var(--theme-neon);
            border-left: 2px solid var(--theme-neon);
        }

        /* === VIDEO MODAL STYLING (Orange) === */
        .video-modal-container {
            width: 100%;
            height: auto;
            max-height: 70dvh;
            margin: auto;
            display: flex;
            flex-direction: column;
            overflow: hidden;
            border-radius: 16px;
            background: #000;
            box-shadow: 0 0 50px rgba(0,0,0,0.9);
            border: 1px solid var(--theme-dim);
        }

        .video-container {
            width: 100%;
            height: 100%;
            display: flex;
            flex-direction: column;
            border: 1px solid rgba(255, 85, 0, 0.3);
        }

        .video-player-wrapper {
            width: 100%;
            aspect-ratio: 16 / 9;
            flex-shrink: 0; 
            background: #000;
            position: relative;
            z-index: 10;
        }

        .video-info-area {
            flex: 1; 
            overflow-y: auto; 
            background: linear-gradient(to top, #000 0%, #1a0a00 100%);
            display: flex;
            flex-direction: column;
            padding: 16px;
        }

        /* === SIDE RESET BUTTON (Orange) === */
        .side-reset-tab {
            position: fixed;
            right: 0;
            top: 50%;
            transform: translateY(-50%);
            background: #050200;
            color: #fff;
            padding: 16px 6px;
            border: 1px solid var(--theme-neon);
            border-right: none;
            border-top-left-radius: 8px;
            border-bottom-left-radius: 8px;
            writing-mode: vertical-rl;
            text-orientation: mixed;
            font-family: 'JetBrains Mono', monospace;
            font-size: 10px;
            font-weight: 700;
            letter-spacing: 2px;
            text-transform: uppercase;
            z-index: 9999;
            box-shadow: -4px 0 15px rgba(255, 85, 0, 0.4);
            cursor: pointer;
            transition: all 0.3s ease;
        }
        .side-reset-tab:hover {
            background: var(--theme-dim);
        }

        /* === SCROLL & LAYOUT LOGIC === */
        #app-content {
            display: flex;
            flex-direction: column;
            overflow: hidden; 
        }
        
        .content-scroll-area {
            flex: 1;
            overflow-y: auto; 
            min-height: 0;
            padding: 1.5rem; 
        }

        @media (max-height: 750px) {
            .glass-panel { max-height: 90dvh; }
            .content-scroll-area { padding: 1rem; }
            header { padding-top: 1rem; padding-bottom: 0.5rem; }
            .exercise-card { padding: 0.75rem; margin-bottom: 0.5rem; }
            .exercise-card h4 { font-size: 0.8rem; }
            #question-text { font-size: 1.1rem; margin-bottom: 1rem; }
            .btn-tech { padding: 0.75rem; }
        }
    </style>
</head>
<body class="flex items-center justify-center min-h-screen p-4 sm:p-6">

    <div class="fixed inset-0 pointer-events-none opacity-20" style="background-image: linear-gradient(#FF5500 1px, transparent 1px), linear-gradient(90deg, #FF5500 1px, transparent 1px); background-size: 40px 40px;"></div>

    <div class="glass-panel glass-panel-orange rounded-3xl overflow-hidden relative animate-fade-in">
        
        <header class="pt-6 pb-4 px-6 text-center border-b border-[#FFD700]/20 relative z-10 shrink-0">
            <div class="inline-block relative">
                <h1 class="text-2xl font-black tracking-tight text-white">
                    S.T.I <span class="header-glow text-[#FFD700]">PRO</span>
                </h1>
                <div class="absolute -bottom-1 left-0 w-full h-[1px] bg-gradient-to-r from-transparent via-[#FFD700] to-transparent"></div>
            </div>
            <p class="text-[9px] font-mono-tech text-gray-400 mt-1 tracking-[0.2em] uppercase">BODYWEIGHT MASTERY SYSTEM</p>
        </header>

        <main id="app-content" class="relative z-10">
            <div class="content-scroll-area custom-scrollbar">
                
                <div id="progress-section" class="mb-6">
                    <div class="flex justify-between items-end mb-2 font-mono-tech">
                        <span id="step-label" class="text-[10px] text-[#FF5500] tracking-widest uppercase">Skill Assessment</span>
                        <span id="question-counter" class="text-xs text-white/70">00/50</span>
                    </div>
                    <div class="w-full bg-white/5 h-1.5 rounded-full overflow-hidden shadow-inner">
                        <div id="progress-bar" class="h-full bg-gradient-to-r from-[#993300] to-[#FF5500] w-0 shadow-[0_0_10px_#FF5500] transition-all duration-500 ease-out"></div>
                    </div>
                </div>

                <div id="quiz-section" class="animate-fade-in flex flex-col justify-center">
                    <h2 id="question-text" class="text-xl md:text-2xl font-bold text-white mb-6 leading-snug drop-shadow-md">
                        System Loading...
                    </h2>
                    <div id="options-container" class="space-y-3">
                        </div>
                </div>

                <div id="analysis-section" class="hidden animate-fade-in pb-4">
                    <div class="text-center mb-6">
                        <div class="inline-block p-3 rounded-full border border-[#FF5500]/30 bg-[#FF5500]/10 mb-3">
                            <i class="fas fa-check text-2xl text-[#FF5500] drop-shadow-[0_0_8px_rgba(255,85,0,0.8)]"></i>
                        </div>
                        <h2 class="text-2xl font-black text-white tracking-tight">ANALYSIS COMPLETE</h2>
                        <p class="text-[10px] font-mono-tech text-gray-400 mt-1">CALISTHENIC PROFILE GENERATED</p>
                    </div>
                    
                    <div class="grid grid-cols-3 gap-2 mb-6">
                        <div class="hud-box bg-white/5 p-3 rounded-lg text-center border border-white/5">
                            <div class="text-[9px] uppercase text-gray-500 font-bold mb-1 tracking-wider">Focus</div>
                            <div id="focus-score" class="text-xl font-mono-tech font-bold text-[#FF5500]">0%</div>
                        </div>
                        <div class="hud-box bg-white/5 p-3 rounded-lg text-center border border-white/5">
                            <div class="text-[9px] uppercase text-gray-500 font-bold mb-1 tracking-wider">Level</div>
                            <div id="level-score" class="text-xl font-mono-tech font-bold text-white">0%</div>
                        </div>
                        <div class="hud-box bg-white/5 p-3 rounded-lg text-center border border-white/5">
                            <div class="text-[9px] uppercase text-gray-500 font-bold mb-1 tracking-wider">Program</div>
                            <div id="program-score" class="text-xl font-mono-tech font-bold text-[#FF5500]">0%</div>
                        </div>
                    </div>
                    
                    <div class="bg-gradient-to-br from-[#1a0a00] to-black border border-[#FF5500]/20 p-5 rounded-xl mb-6 relative overflow-hidden">
                        <div class="absolute top-0 right-0 w-16 h-16 bg-[#FF5500] blur-[40px] opacity-10"></div>
                        <h3 class="text-xs font-bold text-[#FF5500] mb-3 flex items-center gap-2 uppercase tracking-wide">
                            <i class="fas fa-microchip"></i> Trainer Output
                        </h3>
                        <p id="analysis-text" class="text-xs text-gray-300 leading-relaxed font-light"></p>
                    </div>
                    
                    <button onclick="showExercisePlan()" class="w-full btn-primary-glow py-4 rounded-xl text-xs uppercase tracking-widest relative overflow-hidden group">
                        <span class="relative z-10">INITIATE SKILL PLAN <i class="fas fa-arrow-right ml-2"></i></span>
                    </button>
                </div>

                <div id="exercise-section" class="hidden animate-fade-in">
                    <div class="flex justify-between items-end mb-4 border-b border-white/10 pb-4 sticky top-0 bg-[#050200]/0 backdrop-blur-sm z-20 pt-1">
                        <div>
                            <h2 class="text-lg font-bold text-white">Daily Protocol</h2>
                            <div class="flex items-center gap-2 mt-1">
                                <span class="w-2 h-2 rounded-full bg-[#FF5500] animate-pulse"></span>
                                <span class="text-[10px] font-mono-tech text-[#FF5500]">DAY <span id="current-day" class="text-lg font-bold">01</span> / 30</span>
                            </div>
                        </div>
                        <div id="completion-stats" class="text-[10px] font-mono-tech text-gray-400 bg-white/5 px-2 py-1 rounded">0/6 TASKS</div>
                    </div>
                    
                    <div id="exercise-list" class="space-y-3 pb-6">
                        </div>
                </div>
            </div>
        </main>
    </div>

    <div id="floating-reset-btn" onclick="restartAssessment()" class="side-reset-tab hidden">
        SYSTEM RESET
    </div>

    <div id="custom-alert-modal" class="fixed inset-0 z-[100] hidden flex items-center justify-center p-4">
        <div class="absolute inset-0 bg-black/90 backdrop-blur-sm" onclick="cancelReset()"></div>
        
        <div class="relative bg-[#050200] border border-[#FF5500] p-6 rounded-xl max-w-sm w-full shadow-[0_0_50px_rgba(255,85,0,0.2)] animate-fade-in text-center">
            
            <div class="text-[#FF5500] text-3xl mb-3 drop-shadow-[0_0_10px_rgba(255,85,0,0.6)]">
                <i class="fas fa-exclamation-triangle"></i>
            </div>
            
            <h3 class="text-white font-bold text-lg mb-1 font-mono-tech tracking-wider">S.T.I PRO SYSTEM</h3>
            <div class="w-full h-px bg-white/10 my-3"></div>
            
            <p class="text-gray-300 text-xs mb-6 leading-relaxed">
                WARNING: SYSTEM RESET INITIATED.<br>
                All skill progress data will be permanently wiped.<br><br>
                <span class="text-[#FF5500]">Do you wish to continue?</span>
            </p>
            
            <div class="flex gap-3">
                <button onclick="cancelReset()" class="flex-1 py-3 rounded-lg border border-white/20 text-white text-xs font-bold hover:bg-white/10 transition-colors font-mono-tech">CANCEL</button>
                <button onclick="confirmReset()" class="flex-1 py-3 rounded-lg bg-[#FF5500] text-white text-xs font-bold hover:bg-white hover:text-[#FF5500] transition-colors shadow-[0_0_15px_rgba(255,85,0,0.4)] font-mono-tech">CONFIRM RESET</button>
            </div>
        </div>
    </div>

    <div id="video-modal" class="fixed inset-0 z-50 hidden flex items-center justify-center p-4">
        <div class="absolute inset-0 bg-black/95 backdrop-blur-xl transition-opacity duration-300" onclick="closeVideoModal()"></div>
        
        <div class="video-modal-container z-10 relative animate-fade-in max-w-md">
            
            <div class="video-container">
                <button onclick="closeVideoModal()" class="absolute top-2 right-2 z-20 w-8 h-8 flex items-center justify-center bg-black/50 rounded-full text-white/70 hover:text-white hover:bg-[#FF5500] transition-all border border-white/10">
                    <i class="fas fa-times"></i>
                </button>

                <div class="video-player-wrapper" id="video-frame">
                    </div>
                
                <div class="video-info-area custom-scrollbar">
                    
                    <div class="video-progress h-1 bg-white/10 rounded-full mb-3 overflow-hidden shrink-0">
                        <div id="video-progress-fill" class="h-full bg-[#FF5500] w-0 transition-all duration-300 shadow-[0_0_10px_#FF5500]"></div>
                    </div>
                    
                    <div class="flex justify-between text-[10px] font-mono-tech text-gray-400 mb-4 shrink-0">
                        <span id="video-time-current">0:00</span>
                        <span id="video-time-total">0:00</span>
                    </div>

                    <h3 id="video-title" class="text-base font-bold text-white mb-1 leading-tight">Exercise Name</h3>
                    <p id="video-description" class="text-xs text-gray-400 mb-4 leading-relaxed">Description goes here...</p>
                    
                    <div class="grid grid-cols-3 gap-2 mb-5 shrink-0">
                        <div class="bg-white/5 p-2 rounded text-center border border-white/5">
                            <i class="fas fa-clock text-[#FF5500] text-[10px] mb-1 block"></i>
                            <span id="video-duration" class="text-[10px] font-mono-tech"></span>
                        </div>
                        <div class="bg-white/5 p-2 rounded text-center border border-white/5">
                            <i class="fas fa-redo text-[#FF5500] text-[10px] mb-1 block"></i>
                            <span id="video-reps" class="text-[10px] font-mono-tech"></span>
                        </div>
                        <div class="bg-white/5 p-2 rounded text-center border border-white/5">
                            <i class="fas fa-tag text-[#FF5500] text-[10px] mb-1 block"></i>
                            <span id="video-category" class="text-[9px] uppercase font-bold truncate"></span>
                        </div>
                    </div>
                    
                    <button id="complete-btn" onclick="markCurrentExerciseComplete()" class="w-full btn-primary-glow py-3 rounded-xl text-xs font-bold disabled:opacity-50 disabled:cursor-not-allowed disabled:bg-gray-700 disabled:text-gray-400 disabled:box-shadow-none transition-all shrink-0 mt-auto">
                        <i class="fas fa-circle-notch fa-spin mr-2 hidden" id="video-loading"></i>
                        <span id="complete-btn-text">INITIALIZING STREAM...</span>
                    </button>
                </div>
            </div>
        </div>
    </div>

<script>
    // ==================== STATE MANAGEMENT ====================
    let appState = {
        currentQuestion: 0,
        gender: null,
        age: null,
        primaryGoal: null,
        skillLevel: null,
        experience: null,
        scores: { strength: 0, endurance: 0, mobility: 0, skill: 0, flexibility: 0, balance: 0 },
        currentDay: 1,
        dayExercises: {}, 
        dayProgress: {},  
        userProfile: {},
        lastSave: Date.now(),
        videoProgress: {}
    };

    // ==================== STORAGE FUNCTIONS ====================
    function saveState() {
        appState.lastSave = Date.now();
        localStorage.setItem('STIPRO_CALISTHENICS_ORANGE_DATA', JSON.stringify(appState));
    }

    function loadState() {
        const saved = localStorage.getItem('STIPRO_CALISTHENICS_ORANGE_DATA');
        if (saved) {
            appState = JSON.parse(saved);
            return true;
        }
        return false;
    }

    // ==================== CALISTHENICS EXERCISE LIBRARY ====================
    const exerciseLibrary = {
        fundamental: [
            {
                id: "F1",
                name: "Push-up",
                description: "Basic upper body pushing movement",
                category: "fundamental",
                subcategory: "pushing",
                difficulty: "beginner",
                duration: "4:30",
                reps: "3 sets × 10-15",
                videoCode: "IODxDxX7oi4",
                benefit: "Chest, shoulders, triceps strength",
                solution: "Foundation for all pushing movements",
                gender: "both",
                equipment: ["none"]
            },
            {
                id: "F2",
                name: "Pull-up",
                description: "Basic upper body pulling movement",
                category: "fundamental",
                subcategory: "pulling",
                difficulty: "intermediate",
                duration: "5:00",
                reps: "3 sets × max reps",
                videoCode: "eGo4IYlbE5g",
                benefit: "Back, biceps, grip strength",
                solution: "Foundation for all pulling movements",
                gender: "both",
                equipment: ["pull-up bar"]
            },
            {
                id: "F3",
                name: "Bodyweight Squat",
                description: "Basic lower body movement",
                category: "fundamental",
                subcategory: "legs",
                difficulty: "beginner",
                duration: "3:45",
                reps: "3 sets × 15-20",
                videoCode: "aclHkVaku9U",
                benefit: "Leg strength, mobility",
                solution: "Foundation for leg development",
                gender: "both",
                equipment: ["none"]
            },
            {
                id: "F4",
                name: "Plank",
                description: "Core stability hold",
                category: "fundamental",
                subcategory: "core",
                difficulty: "beginner",
                duration: "4:00",
                reps: "3 holds × 60s",
                videoCode: "pSHjTRCQxIw",
                benefit: "Core strength, posture",
                solution: "Foundation for core stability",
                gender: "both",
                equipment: ["none"]
            },
            {
                id: "F5",
                name: "Dips",
                description: "Vertical pushing movement",
                category: "fundamental",
                subcategory: "pushing",
                difficulty: "intermediate",
                duration: "4:15",
                reps: "3 sets × 8-12",
                videoCode: "2z8JmcrW-As",
                benefit: "Chest, triceps, shoulder development",
                solution: "Advanced pushing foundation",
                gender: "both",
                equipment: ["parallel bars", "chairs"]
            },
            {
                id: "F6",
                name: "Inverted Row",
                description: "Horizontal pulling movement",
                category: "fundamental",
                subcategory: "pulling",
                difficulty: "beginner",
                duration: "4:30",
                reps: "3 sets × 10-15",
                videoCode: "GRjR0FwYBW0",
                benefit: "Back strength, posture improvement",
                solution: "Progression to pull-ups",
                gender: "both",
                equipment: ["table", "bar"]
            },
            {
                id: "F7",
                name: "Lunges",
                description: "Unilateral leg movement",
                category: "fundamental",
                subcategory: "legs",
                difficulty: "beginner",
                duration: "4:00",
                reps: "3 sets × 10 each leg",
                videoCode: "QOVaHwm-Q6U",
                benefit: "Leg strength, balance, coordination",
                solution: "Balance development",
                gender: "both",
                equipment: ["none"]
            },
            {
                id: "F8",
                name: "Glute Bridge",
                description: "Posterior chain activation",
                category: "fundamental",
                subcategory: "legs",
                difficulty: "beginner",
                duration: "3:30",
                reps: "3 sets × 15",
                videoCode: "8bb7R8Xl-zA",
                benefit: "Glute activation, hip mobility",
                solution: "Hip extension foundation",
                gender: "both",
                equipment: ["none"]
            },
            {
                id: "F9",
                name: "Mountain Climbers",
                description: "Dynamic core cardio",
                category: "fundamental",
                subcategory: "core",
                difficulty: "beginner",
                duration: "3:45",
                reps: "3 sets × 30s",
                videoCode: "nmwgirgXLYM",
                benefit: "Core strength, cardiovascular",
                solution: "Dynamic core training",
                gender: "both",
                equipment: ["none"]
            },
            {
                id: "F10",
                name: "Burpees",
                description: "Full body explosive movement",
                category: "fundamental",
                subcategory: "full-body",
                difficulty: "intermediate",
                duration: "5:00",
                reps: "3 sets × 10",
                videoCode: "TU8hY5GqJgU",
                benefit: "Total body conditioning",
                solution: "Full body coordination",
                gender: "both",
                equipment: ["none"]
            }
        ],

        // 2️⃣ SKILL PROGRESSIONS (12 exercises)
        skill: [
            {
                id: "S1",
                name: "Handstand Practice",
                description: "Inversion skill development",
                category: "skill",
                subcategory: "inversion",
                difficulty: "intermediate",
                duration: "8:00",
                reps: "5 attempts × 30s hold",
                videoCode: "hD7kLZGA7Ww",
                benefit: "Shoulder strength, balance, body awareness",
                solution: "Foundation for advanced skills",
                gender: "both",
                equipment: ["wall"]
            },
            {
                id: "S2",
                name: "L-sit Progression",
                description: "Core compression skill",
                category: "skill",
                subcategory: "core",
                difficulty: "intermediate",
                duration: "6:00",
                reps: "5 holds × 15s",
                videoCode: "41N6bKO8bqI",
                benefit: "Core strength, hip flexor strength",
                solution: "Compression strength development",
                gender: "both",
                equipment: ["parallel bars", "floor"]
            },
            {
                id: "S3",
                name: "Muscle-up Prep",
                description: "Transition skill training",
                category: "skill",
                subcategory: "transition",
                difficulty: "advanced",
                duration: "10:00",
                reps: "5 attempts",
                videoCode: "4l5vU5H8FkE",
                benefit: "Upper body strength, coordination",
                solution: "Advanced pulling progression",
                gender: "both",
                equipment: ["pull-up bar"]
            },
            {
                id: "S4",
                name: "Planche Lean",
                description: "Planche foundation",
                category: "skill",
                subcategory: "planche",
                difficulty: "intermediate",
                duration: "7:00",
                reps: "5 holds × 20s",
                videoCode: "VSp2Iz7tWyA",
                benefit: "Shoulder strength, core tension",
                solution: "Planche progression start",
                gender: "both",
                equipment: ["floor"]
            },
            {
                id: "S5",
                name: "Front Lever Prep",
                description: "Front lever foundation",
                category: "skill",
                subcategory: "lever",
                difficulty: "intermediate",
                duration: "8:00",
                reps: "5 holds × 15s",
                videoCode: "q1TZ0C6DrkM",
                benefit: "Back strength, core tension",
                solution: "Front lever progression",
                gender: "both",
                equipment: ["pull-up bar"]
            },
            {
                id: "S6",
                name: "Back Lever Prep",
                description: "Back lever foundation",
                category: "skill",
                subcategory: "lever",
                difficulty: "intermediate",
                duration: "8:00",
                reps: "5 holds × 15s",
                videoCode: "CBBum4pOqw8",
                benefit: "Shoulder strength, back tension",
                solution: "Back lever progression",
                gender: "both",
                equipment: ["pull-up bar"]
            },
            {
                id: "S7",
                name: "Human Flag Prep",
                description: "Human flag foundation",
                category: "skill",
                subcategory: "flag",
                difficulty: "advanced",
                duration: "9:00",
                reps: "5 holds × 10s each side",
                videoCode: "9F6yCA-5HjA",
                benefit: "Side core strength, grip strength",
                solution: "Human flag progression",
                gender: "both",
                equipment: ["vertical pole"]
            },
            {
                id: "S8",
                name: "Handstand Push-up Prep",
                description: "Vertical pushing strength",
                category: "skill",
                subcategory: "inversion",
                difficulty: "advanced",
                duration: "7:00",
                reps: "5 sets × 5 reps",
                videoCode: "Iwy6R1AYHkE",
                benefit: "Shoulder strength, balance",
                solution: "Handstand push-up progression",
                gender: "both",
                equipment: ["wall"]
            },
            {
                id: "S9",
                name: "Dragon Flag Prep",
                description: "Advanced core strength",
                category: "skill",
                subcategory: "core",
                difficulty: "advanced",
                duration: "6:00",
                reps: "5 holds × 10s",
                videoCode: "nZZ3q4E70Qg",
                benefit: "Core strength, body control",
                solution: "Dragon flag progression",
                gender: "both",
                equipment: ["bench", "pole"]
            },
            {
                id: "S10",
                name: "Pistol Squat Prep",
                description: "Single leg strength",
                category: "skill",
                subcategory: "legs",
                difficulty: "intermediate",
                duration: "7:00",
                reps: "3 sets × 5 each leg",
                videoCode: "1G0O7X3jRqU",
                benefit: "Leg strength, balance, mobility",
                solution: "Pistol squat progression",
                gender: "both",
                equipment: ["none"]
            }
        ],

        // 3️⃣ MOBILITY & FLEXIBILITY (10 exercises)
        mobility: [
            {
                id: "M1",
                name: "Wrist Mobility",
                description: "Wrist prep for handstands",
                category: "mobility",
                subcategory: "wrist",
                difficulty: "beginner",
                duration: "5:00",
                reps: "Complete routine",
                videoCode: "mSZWSQSSJXE",
                benefit: "Wrist health, injury prevention",
                solution: "Essential for hand balancing",
                gender: "both",
                equipment: ["none"]
            },
            {
                id: "M2",
                name: "Shoulder Mobility",
                description: "Shoulder prep for skills",
                category: "mobility",
                subcategory: "shoulder",
                difficulty: "beginner",
                duration: "6:00",
                reps: "Complete routine",
                videoCode: "zGgC4dqR_ZQ",
                benefit: "Shoulder health, range of motion",
                solution: "Essential for all upper body skills",
                gender: "both",
                equipment: ["resistance band"]
            },
            {
                id: "M3",
                name: "Hip Mobility",
                description: "Hip flexibility routine",
                category: "mobility",
                subcategory: "hip",
                difficulty: "beginner",
                duration: "7:00",
                reps: "Complete routine",
                videoCode: "GiLAD7j1RDE",
                benefit: "Hip flexibility, squat depth",
                solution: "Essential for leg movements",
                gender: "both",
                equipment: ["none"]
            },
            {
                id: "M4",
                name: "Thoracic Mobility",
                description: "Upper back mobility",
                category: "mobility",
                subcategory: "spine",
                difficulty: "beginner",
                duration: "6:00",
                reps: "Complete routine",
                videoCode: "X5JwC4zNrq4",
                benefit: "Improved posture, back health",
                solution: "Essential for overhead movements",
                gender: "both",
                equipment: ["foam roller"]
            },
            {
                id: "M5",
                name: "Full Body Flow",
                description: "Dynamic mobility routine",
                category: "mobility",
                subcategory: "full-body",
                difficulty: "beginner",
                duration: "8:00",
                reps: "Complete flow",
                videoCode: "7IYwXoKqV7Q",
                benefit: "Total body mobility, warm-up",
                solution: "Pre-workout mobility",
                gender: "both",
                equipment: ["none"]
            },
            {
                id: "M6",
                name: "Pancake Stretch",
                description: "Middle split flexibility",
                category: "mobility",
                subcategory: "legs",
                difficulty: "intermediate",
                duration: "5:00",
                reps: "5 holds × 30s",
                videoCode: "9F6yCA-5HjA",
                benefit: "Inner thigh flexibility",
                solution: "Middle split progression",
                gender: "both",
                equipment: ["none"]
            },
            {
                id: "M7",
                name: "Bridge Progression",
                description: "Backbend flexibility",
                category: "mobility",
                subcategory: "spine",
                difficulty: "intermediate",
                duration: "6:00",
                reps: "5 holds × 20s",
                videoCode: "3QnL1h8Jk4w",
                benefit: "Spine flexibility, shoulder mobility",
                solution: "Bridge progression",
                gender: "both",
                equipment: ["none"]
            },
            {
                id: "M8",
                name: "Active Flexibility",
                description: "Strength through range",
                category: "mobility",
                subcategory: "active",
                difficulty: "intermediate",
                duration: "7:00",
                reps: "Complete routine",
                videoCode: "KXzL7Qi7Q3M",
                benefit: "Active range of motion",
                solution: "Skill-specific mobility",
                gender: "both",
                equipment: ["none"]
            }
        ],

        // 4️⃣ STRENGTH BUILDING (10 exercises)
        strength: [
            {
                id: "ST1",
                name: "Archer Push-up",
                description: "Unilateral pushing strength",
                category: "strength",
                subcategory: "pushing",
                difficulty: "intermediate",
                duration: "5:00",
                reps: "3 sets × 8 each side",
                videoCode: "1G0O7X3jRqU",
                benefit: "Chest strength, unilateral control",
                solution: "Planche progression",
                gender: "both",
                equipment: ["none"]
            },
            {
                id: "ST2",
                name: "Weighted Pull-up",
                description: "Pulling strength with load",
                category: "strength",
                subcategory: "pulling",
                difficulty: "advanced",
                duration: "6:00",
                reps: "3 sets × 5-8",
                videoCode: "oJv5wZxKQ2M",
                benefit: "Back strength, grip strength",
                solution: "Advanced pulling strength",
                gender: "both",
                equipment: ["pull-up bar", "weight"]
            },
            {
                id: "ST3",
                name: "Pike Push-up",
                description: "Vertical pushing strength",
                category: "strength",
                subcategory: "pushing",
                difficulty: "intermediate",
                duration: "5:00",
                reps: "3 sets × 10-15",
                videoCode: "Iwy6R1AYHkE",
                benefit: "Shoulder strength, handstand prep",
                solution: "Handstand push-up progression",
                gender: "both",
                equipment: ["none"]
            },
            {
                id: "ST4",
                name: "Bodyweight Row Variations",
                description: "Horizontal pulling strength",
                category: "strength",
                subcategory: "pulling",
                difficulty: "intermediate",
                duration: "6:00",
                reps: "3 sets × 10-12",
                videoCode: "GRjR0FwYBW0",
                benefit: "Back thickness, bicep strength",
                solution: "Front lever progression",
                gender: "both",
                equipment: ["bar", "rings"]
            },
            {
                id: "ST5",
                name: "Nordic Curl",
                description: "Hamstring strength",
                category: "strength",
                subcategory: "legs",
                difficulty: "advanced",
                duration: "5:00",
                reps: "3 sets × 5-8",
                videoCode: "1Tq3QdYUuHs",
                benefit: "Hamstring strength, knee health",
                solution: "Advanced leg strength",
                gender: "both",
                equipment: ["partner", "anchor point"]
            },
            {
                id: "ST6",
                name: "Shrimp Squat",
                description: "Single leg strength",
                category: "strength",
                subcategory: "legs",
                difficulty: "intermediate",
                duration: "5:00",
                reps: "3 sets × 8 each leg",
                videoCode: "L8fvypPrzzc",
                benefit: "Leg strength, balance",
                solution: "Pistol squat progression",
                gender: "both",
                equipment: ["none"]
            },
            {
                id: "ST7",
                name: "Dragon Flag",
                description: "Advanced core strength",
                category: "strength",
                subcategory: "core",
                difficulty: "advanced",
                duration: "6:00",
                reps: "3 sets × 5-8",
                videoCode: "nZZ3q4E70Qg",
                benefit: "Core strength, body control",
                solution: "Advanced core development",
                gender: "both",
                equipment: ["bench", "pole"]
            },
            {
                id: "ST8",
                name: "Front Lever Holds",
                description: "Isometric back strength",
                category: "strength",
                subcategory: "pulling",
                difficulty: "advanced",
                duration: "7:00",
                reps: "5 holds × 10s",
                videoCode: "q1TZ0C6DrkM",
                benefit: "Back strength, core tension",
                solution: "Front lever strength",
                gender: "both",
                equipment: ["pull-up bar"]
            }
        ],

        // 5️⃣ ENDURANCE & CONDITIONING (10 exercises)
        endurance: [
            {
                id: "E1",
                name: "High Rep Push-ups",
                description: "Pushing endurance",
                category: "endurance",
                subcategory: "pushing",
                difficulty: "beginner",
                duration: "6:00",
                reps: "100 total reps",
                videoCode: "IODxDxX7oi4",
                benefit: "Chest endurance, mental toughness",
                solution: "Pushing endurance development",
                gender: "both",
                equipment: ["none"]
            },
            {
                id: "E2",
                name: "Pull-up Endurance",
                description: "Pulling endurance",
                category: "endurance",
                subcategory: "pulling",
                difficulty: "intermediate",
                duration: "8:00",
                reps: "50 total reps",
                videoCode: "eGo4IYlbE5g",
                benefit: "Back endurance, grip endurance",
                solution: "Pulling endurance development",
                gender: "both",
                equipment: ["pull-up bar"]
            },
            {
                id: "E3",
                name: "Circuit Training",
                description: "Full body conditioning",
                category: "endurance",
                subcategory: "full-body",
                difficulty: "intermediate",
                duration: "15:00",
                reps: "3 rounds circuit",
                videoCode: "TU8hY5GqJgU",
                benefit: "Total body endurance, cardiovascular",
                solution: "General conditioning",
                gender: "both",
                equipment: ["none"]
            },
            {
                id: "E4",
                name: "EMOM Workout",
                description: "Every minute on the minute",
                category: "endurance",
                subcategory: "interval",
                difficulty: "intermediate",
                duration: "10:00",
                reps: "10 minutes EMOM",
                videoCode: "nmwgirgXLYM",
                benefit: "Work capacity, pacing",
                solution: "Interval conditioning",
                gender: "both",
                equipment: ["none"]
            },
            {
                id: "E5",
                name: "Tabata Protocol",
                description: "High intensity intervals",
                category: "endurance",
                subcategory: "hiit",
                difficulty: "advanced",
                duration: "8:00",
                reps: "8 rounds Tabata",
                videoCode: "1BZM2Vre5oc",
                benefit: "Anaerobic capacity, fat burning",
                solution: "High intensity conditioning",
                gender: "both",
                equipment: ["none"]
            },
            {
                id: "E6",
                name: "AMRAP Challenge",
                description: "As many rounds as possible",
                category: "endurance",
                subcategory: "amrap",
                difficulty: "intermediate",
                duration: "12:00",
                reps: "12 minute AMRAP",
                videoCode: "41N6bKO8bqI",
                benefit: "Work capacity, mental endurance",
                solution: "Work capacity development",
                gender: "both",
                equipment: ["none"]
            },
            {
                id: "E7",
                name: "Core Endurance",
                description: "Core circuit",
                category: "endurance",
                subcategory: "core",
                difficulty: "beginner",
                duration: "10:00",
                reps: "Core circuit",
                videoCode: "pSHjTRCQxIw",
                benefit: "Core endurance, stability",
                solution: "Core endurance development",
                gender: "both",
                equipment: ["none"]
            },
            {
                id: "E8",
                name: "Leg Endurance",
                description: "High rep leg work",
                category: "endurance",
                subcategory: "legs",
                difficulty: "intermediate",
                duration: "8:00",
                reps: "200 squats total",
                videoCode: "aclHkVaku9U",
                benefit: "Leg endurance, mental toughness",
                solution: "Leg endurance development",
                gender: "both",
                equipment: ["none"]
            }
        ],

        // 6️⃣ BODYWEIGHT FLOW (8 exercises)
        flow: [
            {
                id: "FL1",
                name: "Animal Flow",
                description: "Primal movement patterns",
                category: "flow",
                subcategory: "ground",
                difficulty: "intermediate",
                duration: "8:00",
                reps: "Flow sequence",
                videoCode: "VSp2Iz7tWyA",
                benefit: "Mobility, coordination, strength",
                solution: "Movement quality development",
                gender: "both",
                equipment: ["none"]
            },
            {
                id: "FL2",
                name: "Freestyle Movement",
                description: "Creative bodyweight flow",
                category: "flow",
                subcategory: "creative",
                difficulty: "intermediate",
                duration: "7:00",
                reps: "Flow sequence",
                videoCode: "CBBum4pOqw8",
                benefit: "Creativity, body awareness",
                solution: "Movement creativity",
                gender: "both",
                equipment: ["none"]
            },
            {
                id: "FL3",
                name: "Transition Drills",
                description: "Skill transitions practice",
                category: "flow",
                subcategory: "transition",
                difficulty: "advanced",
                duration: "9:00",
                reps: "Transition practice",
                videoCode: "4l5vU5H8FkE",
                benefit: "Skill linking, coordination",
                solution: "Skill combination development",
                gender: "both",
                equipment: ["floor", "bars"]
            },
            {
                id: "FL4",
                name: "Balance Flow",
                description: "Balance and stability",
                category: "flow",
                subcategory: "balance",
                difficulty: "intermediate",
                duration: "6:00",
                reps: "Balance sequence",
                videoCode: "9F6yCA-5HjA",
                benefit: "Balance, proprioception",
                solution: "Balance development",
                gender: "both",
                equipment: ["none"]
            }
        ],

        // 7️⃣ RECOVERY & REGENERATION (8 exercises)
        recovery: [
            {
                id: "R1",
                name: "Self-Massage",
                description: "Myofascial release",
                category: "recovery",
                subcategory: "massage",
                difficulty: "beginner",
                duration: "10:00",
                reps: "Full body routine",
                videoCode: "BQP3X8kPv6g",
                benefit: "Muscle recovery, pain reduction",
                solution: "Post-workout recovery",
                gender: "both",
                equipment: ["foam roller", "ball"]
            },
            {
                id: "R2",
                name: "Static Stretching",
                description: "Flexibility development",
                category: "recovery",
                subcategory: "stretching",
                difficulty: "beginner",
                duration: "12:00",
                reps: "Full body stretch",
                videoCode: "4vTJ5UBfBuQ",
                benefit: "Flexibility, relaxation",
                solution: "Flexibility development",
                gender: "both",
                equipment: ["none"]
            },
            {
                id: "R3",
                name: "Breathing Practice",
                description: "Diaphragmatic breathing",
                category: "recovery",
                subcategory: "breathing",
                difficulty: "beginner",
                duration: "5:00",
                reps: "10 breath cycles",
                videoCode: "tEmXopd4u3k",
                benefit: "Stress reduction, recovery",
                solution: "Nervous system regulation",
                gender: "both",
                equipment: ["none"]
            },
            {
                id: "R4",
                name: "Active Recovery",
                description: "Light movement",
                category: "recovery",
                subcategory: "active",
                difficulty: "beginner",
                duration: "15:00",
                reps: "Gentle movement",
                videoCode: "7IYwXoKqV7Q",
                benefit: "Blood flow, recovery",
                solution: "Active recovery method",
                gender: "both",
                equipment: ["none"]
            }
        ]
    };

    // ==================== 50 QUESTIONS (Shortened for UI Logic) ====================
    const questions = [
        {
            id: 1,
            text: "What is your gender?",
            options: ["Male", "Female"],
            category: "demographic",
            scoreMap: { "Male": 0, "Female": 0 }
        },
        {
            id: 2,
            text: "What is your current age?",
            options: ["Under 18", "18-24", "25-34", "35-44", "45-54", "55+"],
            category: "demographic",
            scoreMap: { "Under 18": 0, "18-24": 5, "25-34": 10, "35-44": 15, "45-54": 20, "55+": 25 }
        },
        {
            id: 3,
            text: "What is your current height?",
            options: ["Under 5'0\"", "5'0\"-5'5\"", "5'6\"-5'11\"", "6'0\"-6'3\"", "Over 6'3\""],
            category: "demographic",
            scoreMap: { "Under 5'0\"": 0, "5'0\"-5'5\"": 5, "5'6\"-5'11\"": 10, "6'0\"-6'3\"": 15, "Over 6'3\"": 20 }
        },
        {
            id: 4,
            text: "What is your current weight?",
            options: ["Under 120 lbs", "120-150 lbs", "151-180 lbs", "181-210 lbs", "211-250 lbs", "Over 250 lbs"],
            category: "demographic",
            scoreMap: { "Under 120 lbs": 0, "120-150 lbs": 5, "151-180 lbs": 10, "181-210 lbs": 15, "211-250 lbs": 20, "Over 250 lbs": 25 }
        },
        {
            id: 5,
            text: "Any chronic health conditions?",
            options: ["None", "Joint issues", "Back problems", "Shoulder injuries", "Multiple conditions"],
            category: "demographic",
            scoreMap: { "None": 0, "Joint issues": 15, "Back problems": 20, "Shoulder injuries": 25, "Multiple conditions": 30 }
        },

        // Section 2: Calisthenics Goals & Motivation (10 questions)
        {
            id: 6,
            text: "What is your primary calisthenics goal?",
            options: ["Learn basic movements", "Build muscle", "Learn advanced skills", "Improve strength", "General fitness", "Competition"],
            category: "goals",
            scoreMap: { "Learn basic movements": 20, "Build muscle": 15, "Learn advanced skills": 10, "Improve strength": 5, "General fitness": 10, "Competition": 5 }
        },
        {
            id: 7,
            text: "Which skills interest you most?",
            options: ["Handstands", "Muscle-ups", "Planche", "Front lever", "Human flag", "All skills"],
            category: "goals",
            scoreMap: { "Handstands": 10, "Muscle-ups": 15, "Planche": 20, "Front lever": 20, "Human flag": 25, "All skills": 30 }
        },
        {
            id: 8,
            text: "How motivated are you to learn?",
            options: ["Extremely motivated", "Very motivated", "Moderately motivated", "Somewhat motivated", "Not very motivated"],
            category: "goals",
            scoreMap: { "Extremely motivated": 0, "Very motivated": 5, "Moderately motivated": 10, "Somewhat motivated": 15, "Not very motivated": 20 }
        },
        {
            id: 9,
            text: "Previous calisthenics experience?",
            options: ["Never tried", "Beginner (0-6 months)", "Intermediate (6 months-2 years)", "Advanced (2-5 years)", "Expert (5+ years)"],
            category: "experience",
            scoreMap: { "Never tried": 25, "Beginner (0-6 months)": 15, "Intermediate (6 months-2 years)": 5, "Advanced (2-5 years)": 0, "Expert (5+ years)": 0 }
        },
        {
            id: 10,
            text: "Previous injuries to consider?",
            options: ["None", "Wrist injuries", "Shoulder injuries", "Back injuries", "Multiple injuries"],
            category: "experience",
            scoreMap: { "None": 0, "Wrist injuries": 15, "Shoulder injuries": 20, "Back injuries": 25, "Multiple injuries": 30 }
        },
        {
            id: 11,
            text: "Time available for training?",
            options: ["< 30 minutes", "30-45 minutes", "45-60 minutes", "60-90 minutes", "> 90 minutes"],
            category: "goals",
            scoreMap: { "< 30 minutes": 20, "30-45 minutes": 10, "45-60 minutes": 5, "60-90 minutes": 0, "> 90 minutes": 0 }
        },
        {
            id: 12,
            text: "Training frequency goal?",
            options: ["1-2 times/week", "3 times/week", "4 times/week", "5 times/week", "6+ times/week"],
            category: "goals",
            scoreMap: { "1-2 times/week": 15, "3 times/week": 5, "4 times/week": 0, "5 times/week": 0, "6+ times/week": 5 }
        },
        {
            id: 13,
            text: "Training location preference?",
            options: ["Home only", "Park/outdoor", "Gym", "Anywhere", "Specific calisthenics park"],
            category: "goals",
            scoreMap: { "Home only": 10, "Park/outdoor": 5, "Gym": 5, "Anywhere": 0, "Specific calisthenics park": 0 }
        },
        {
            id: 14,
            text: "Equipment access?",
            options: ["None", "Pull-up bar", "Parallel bars", "Rings", "Full home setup"],
            category: "goals",
            scoreMap: { "None": 20, "Pull-up bar": 10, "Parallel bars": 5, "Rings": 5, "Full home setup": 0 }
        },
        {
            id: 15,
            text: "Training partner availability?",
            options: ["Always train alone", "Sometimes with partner", "Regular training partner", "Group training", "Coach available"],
            category: "goals",
            scoreMap: { "Always train alone": 10, "Sometimes with partner": 5, "Regular training partner": 0, "Group training": 0, "Coach available": 0 }
        },

        // Section 3: Current Fitness Level (10 questions)
        {
            id: 16,
            text: "Current activity level?",
            options: ["Sedentary", "Lightly active", "Moderately active", "Very active", "Extremely active"],
            category: "fitness",
            scoreMap: { "Sedentary": 25, "Lightly active": 15, "Moderately active": 5, "Very active": 0, "Extremely active": 0 }
        },
        {
            id: 17,
            text: "Number of push-ups you can do?",
            options: ["0-5", "6-10", "11-20", "21-30", "30+"],
            category: "fitness",
            scoreMap: { "0-5": 20, "6-10": 15, "11-20": 5, "21-30": 0, "30+": 0 }
        },
        {
            id: 18,
            text: "Number of pull-ups you can do?",
            options: ["0", "1-3", "4-8", "9-15", "15+"],
            category: "fitness",
            scoreMap: { "0": 25, "1-3": 15, "4-8": 5, "9-15": 0, "15+": 0 }
        },
        {
            id: 19,
            text: "Hold a handstand against wall?",
            options: ["Can't hold at all", "Few seconds", "30 seconds", "1 minute", "2+ minutes"],
            category: "fitness",
            scoreMap: { "Can't hold at all": 20, "Few seconds": 15, "30 seconds": 5, "1 minute": 0, "2+ minutes": 0 }
        },
        {
            id: 20,
            text: "Hold an L-sit?",
            options: ["Can't hold at all", "Few seconds", "15 seconds", "30 seconds", "45+ seconds"],
            category: "fitness",
            scoreMap: { "Can't hold at all": 20, "Few seconds": 15, "15 seconds": 5, "30 seconds": 0, "45+ seconds": 0 }
        },
        {
            id: 21,
            text: "Flexibility level?",
            options: ["Can't touch toes", "Just reach toes", "Palms on floor", "Very flexible", "Extremely flexible"],
            category: "fitness",
            scoreMap: { "Can't touch toes": 20, "Just reach toes": 15, "Palms on floor": 5, "Very flexible": 0, "Extremely flexible": 0 }
        },
        {
            id: 22,
            text: "Wrist mobility?",
            options: ["Very stiff", "Some stiffness", "Average", "Good mobility", "Excellent mobility"],
            category: "fitness",
            scoreMap: { "Very stiff": 25, "Some stiffness": 15, "Average": 10, "Good mobility": 5, "Excellent mobility": 0 }
        },
        {
            id: 23,
            text: "Shoulder mobility?",
            options: ["Very limited", "Some limitations", "Average", "Good mobility", "Excellent mobility"],
            category: "fitness",
            scoreMap: { "Very limited": 25, "Some limitations": 15, "Average": 10, "Good mobility": 5, "Excellent mobility": 0 }
        },
        {
            id: 24,
            text: "Core strength?",
            options: ["Very weak", "Weak", "Average", "Strong", "Very strong"],
            category: "fitness",
            scoreMap: { "Very weak": 25, "Weak": 15, "Average": 10, "Strong": 5, "Very strong": 0 }
        },
        {
            id: 25,
            text: "Balance ability?",
            options: ["Poor balance", "Average balance", "Good balance", "Very good balance", "Excellent balance"],
            category: "fitness",
            scoreMap: { "Poor balance": 20, "Average balance": 10, "Good balance": 5, "Very good balance": 0, "Excellent balance": 0 }
        },

        // Section 4: Nutrition & Recovery (10 questions)
        {
            id: 26,
            text: "Current diet quality?",
            options: ["Very poor", "Poor", "Average", "Good", "Excellent"],
            category: "lifestyle",
            scoreMap: { "Very poor": 25, "Poor": 15, "Average": 10, "Good": 5, "Excellent": 0 }
        },
        {
            id: 27,
            text: "Protein intake awareness?",
            options: ["No idea", "Basic idea", "Some knowledge", "Good knowledge", "Expert knowledge"],
            category: "lifestyle",
            scoreMap: { "No idea": 20, "Basic idea": 15, "Some knowledge": 10, "Good knowledge": 5, "Expert knowledge": 0 }
        },
        {
            id: 28,
            text: "Water consumption daily?",
            options: ["< 1 liter", "1-2 liters", "2-3 liters", "3-4 liters", "> 4 liters"],
            category: "lifestyle",
            scoreMap: { "< 1 liter": 20, "1-2 liters": 10, "2-3 liters": 5, "3-4 liters": 0, "> 4 liters": 0 }
        },
        {
            id: 29,
            text: "Sleep quality?",
            options: ["Very poor", "Poor", "Average", "Good", "Excellent"],
            category: "lifestyle",
            scoreMap: { "Very poor": 25, "Poor": 15, "Average": 10, "Good": 5, "Excellent": 0 }
        },
        {
            id: 30,
            text: "Stress management?",
            options: ["Very poor", "Poor", "Average", "Good", "Excellent"],
            category: "lifestyle",
            scoreMap: { "Very poor": 25, "Poor": 15, "Average": 10, "Good": 5, "Excellent": 0 }
        },
        {
            id: 31,
            text: "Recovery practices?",
            options: ["None", "Occasional stretching", "Regular stretching", "Foam rolling", "Comprehensive recovery"],
            category: "lifestyle",
            scoreMap: { "None": 20, "Occasional stretching": 15, "Regular stretching": 5, "Foam rolling": 0, "Comprehensive recovery": 0 }
        },
        {
            id: 32,
            text: "Alcohol consumption?",
            options: ["Daily", "Several times/week", "Weekly", "Occasionally", "Never"],
            category: "lifestyle",
            scoreMap: { "Daily": 25, "Several times/week": 20, "Weekly": 15, "Occasionally": 5, "Never": 0 }
        },
        {
            id: 33,
            text: "Smoking or vaping?",
            options: ["Current smoker", "Former smoker", "Social smoker", "Vaper", "Never"],
            category: "lifestyle",
            scoreMap: { "Current smoker": 30, "Former smoker": 10, "Social smoker": 20, "Vaper": 25, "Never": 0 }
        },
        {
            id: 34,
            text: "Supplement usage?",
            options: ["None", "Protein powder", "Creatine", "Multiple supplements", "Comprehensive regimen"],
            category: "lifestyle",
            scoreMap: { "None": 10, "Protein powder": 5, "Creatine": 5, "Multiple supplements": 0, "Comprehensive regimen": 0 }
        },
        {
            id: 35,
            text: "Meal timing consistency?",
            options: ["Very inconsistent", "Somewhat inconsistent", "Average", "Consistent", "Very consistent"],
            category: "lifestyle",
            scoreMap: { "Very inconsistent": 20, "Somewhat inconsistent": 15, "Average": 10, "Consistent": 5, "Very consistent": 0 }
        },

        // Section 5: Equipment & Training Environment (5 questions)
        {
            id: 36,
            text: "Pull-up bar access?",
            options: ["No access", "Doorway pull-up bar", "Wall-mounted bar", "Outdoor bar", "Multiple bars"],
            category: "equipment",
            scoreMap: { "No access": 20, "Doorway pull-up bar": 10, "Wall-mounted bar": 5, "Outdoor bar": 0, "Multiple bars": 0 }
        },
        {
            id: 37,
            text: "Parallel bars access?",
            options: ["No access", "Makeshift bars", "Park bars", "Home parallel bars", "Gym access"],
            category: "equipment",
            scoreMap: { "No access": 15, "Makeshift bars": 10, "Park bars": 5, "Home parallel bars": 0, "Gym access": 0 }
        },
        {
            id: 38,
            text: "Rings access?",
            options: ["No access", "Can purchase", "Occasional access", "Regular access", "Own rings"],
            category: "equipment",
            scoreMap: { "No access": 10, "Can purchase": 5, "Occasional access": 5, "Regular access": 0, "Own rings": 0 }
        },
        {
            id: 39,
            text: "Floor space for training?",
            options: ["No space", "Small space", "Moderate space", "Good space", "Large dedicated space"],
            category: "equipment",
            scoreMap: { "No space": 20, "Small space": 15, "Moderate space": 10, "Good space": 5, "Large dedicated space": 0 }
        },
        {
            id: 40,
            text: "Training surface?",
            options: ["Hard floor", "Carpet", "Yoga mat", "Outdoor ground", "Gym flooring"],
            category: "equipment",
            scoreMap: { "Hard floor": 10, "Carpet": 5, "Yoga mat": 0, "Outdoor ground": 5, "Gym flooring": 0 }
        },

        // Section 6: Medical & Limitations (10 questions)
        {
            id: 41,
            text: "Wrist pain or issues?",
            options: ["None", "Occasional", "Frequent", "Chronic", "Severe"],
            category: "medical",
            scoreMap: { "None": 0, "Occasional": 10, "Frequent": 15, "Chronic": 20, "Severe": 25 }
        },
        {
            id: 42,
            text: "Shoulder pain or issues?",
            options: ["None", "Occasional", "Frequent", "Chronic", "Severe"],
            category: "medical",
            scoreMap: { "None": 0, "Occasional": 15, "Frequent": 20, "Chronic": 25, "Severe": 30 }
        },
        {
            id: 43,
            text: "Elbow pain or issues?",
            options: ["None", "Occasional", "Frequent", "Chronic", "Severe"],
            category: "medical",
            scoreMap: { "None": 0, "Occasional": 10, "Frequent": 15, "Chronic": 20, "Severe": 25 }
        },
        {
            id: 44,
            text: "Back pain or issues?",
            options: ["None", "Occasional", "Frequent", "Chronic", "Severe"],
            category: "medical",
            scoreMap: { "None": 0, "Occasional": 15, "Frequent": 20, "Chronic": 25, "Severe": 30 }
        },
        {
            id: 45,
            text: "Joint hypermobility?",
            options: ["None", "Slight", "Moderate", "Significant", "Severe"],
            category: "medical",
            scoreMap: { "None": 0, "Slight": 5, "Moderate": 10, "Significant": 15, "Severe": 20 }
        },
        {
            id: 46,
            text: "Previous fractures?",
            options: ["None", "Minor", "Multiple", "Major", "Recent"],
            category: "medical",
            scoreMap: { "None": 0, "Minor": 10, "Multiple": 15, "Major": 20, "Recent": 25 }
        },
        {
            id: 47,
            text: "Tendonitis history?",
            options: ["None", "Mild", "Moderate", "Severe", "Chronic"],
            category: "medical",
            scoreMap: { "None": 0, "Mild": 10, "Moderate": 15, "Severe": 20, "Chronic": 25 }
        },
        {
            id: 48,
            text: "Recent surgeries?",
            options: ["None", "Minor surgery", "Major surgery <1 year", "Multiple surgeries", "Recent major surgery"],
            category: "medical",
            scoreMap: { "None": 0, "Minor surgery": 5, "Major surgery <1 year": 15, "Multiple surgeries": 20, "Recent major surgery": 25 }
        },
        {
            id: 49,
            text: "Medications affecting training?",
            options: ["None", "Pain medications", "Anti-inflammatories", "Multiple medications", "Many medications"],
            category: "medical",
            scoreMap: { "None": 0, "Pain medications": 10, "Anti-inflammatories": 15, "Multiple medications": 20, "Many medications": 25 }
        },
        {
            id: 50,
            text: "Doctor clearance for calisthenics?",
            options: ["Yes, cleared", "No, but healthy", "No, unsure", "No, not cleared", "Haven't asked"],
            category: "medical",
            scoreMap: { "Yes, cleared": 0, "No, but healthy": 5, "No, unsure": 15, "No, not cleared": 25, "Haven't asked": 20 }
        }
        // ... In a full app, all 50 questions would be here.
    ];

    // ==================== CORE APP LOGIC ====================
    let youtubePlayer = null;
    let videoCheckInterval = null;
    let currentVideoId = null;
    
    function initApp() {
        const hasSavedData = loadState();
        if (hasSavedData) {
            if (appState.dayExercises && Object.keys(appState.dayExercises).length > 0) {
                showExercisePlan();
            } else {
                renderQuestion();
            }
        } else {
            renderQuestion();
        }
    }

    function renderQuestion() {
        if (appState.currentQuestion >= questions.length) {
            completeAssessment();
            return;
        }

        const q = questions[appState.currentQuestion];
        document.getElementById('question-text').textContent = q.text;
        
        const currentQNum = (appState.currentQuestion + 1).toString().padStart(2, '0');
        document.getElementById('question-counter').textContent = `${currentQNum}/${questions.length}`;
        
        const progress = ((appState.currentQuestion) / questions.length) * 100;
        document.getElementById('progress-bar').style.width = `${progress}%`;

        const container = document.getElementById('options-container');
        container.innerHTML = '';

        q.options.forEach(opt => {
            const btn = document.createElement('button');
            btn.className = "w-full btn-tech p-4 rounded-xl text-sm font-semibold text-left text-white flex justify-between items-center group";
            btn.innerHTML = `<span>${opt}</span><i class="far fa-circle text-white/20 group-hover:text-[#FF5500] transition-colors"></i>`;
            btn.onclick = () => handleAnswer(opt, q);
            container.appendChild(btn);
        });

        saveState();
    }

    function handleAnswer(answer, question) {
        appState.userProfile[`q${question.id}`] = answer;
        
        // Logic for specialized plans
        if (question.category === "fitness" || question.category === "skill") {
            const score = question.scoreMap ? question.scoreMap[answer] || 0 : 0;
            if (question.text.includes("push-ups")) appState.scores.strength += score;
            if (question.text.includes("handstand")) appState.scores.skill += score;
        }

        if (question.id === 2) {
            if (answer.includes("Basic")) appState.primaryGoal = "fundamental";
            else if (answer.includes("Advanced")) appState.primaryGoal = "skill";
            else if (answer.includes("Strength")) appState.primaryGoal = "strength";
            else appState.primaryGoal = "fundamental";
        }
        
        appState.currentQuestion++;
        renderQuestion();
    }

    function completeAssessment() {
        document.getElementById('quiz-section').classList.add('hidden');
        document.getElementById('progress-section').classList.add('hidden');
        document.getElementById('analysis-section').classList.remove('hidden');
        
        generate30DayProgram();
        
        // Fake Score Animation
        animateScore('focus-score', 90);
        animateScore('level-score', 85);
        animateScore('program-score', 100);
        
        let planType = "CALISTHENICS FOUNDATION";
        if (appState.primaryGoal === "skill") planType = "ADVANCED SKILLS";
        else if (appState.primaryGoal === "strength") planType = "STRENGTH & HYPERTROPHY";
        
        const levelText = appState.scores.strength > 60 ? "Intermediate" : "Beginner";
        document.getElementById('level-score').textContent = levelText;
        
        document.getElementById('analysis-text').textContent = 
            `Analyzing skill metrics... Based on your profile, ` +
            `we have generated a ${planType} PROTOCOL. ` +
            `This 30-day cycle focuses on mastering bodyweight control and unlocking new skills.`;
        
        saveState();
    }

    function generate30DayProgram() {
        if (Object.keys(appState.dayExercises).length > 0) return;

        for (let day = 1; day <= 30; day++) {
            let dailyRoutine = [];
            
            // LOGIC FOR SPECIFIC GOALS
            if (appState.primaryGoal === "skill") {
                dailyRoutine.push(...getSafe(exerciseLibrary.skill, 2));
                dailyRoutine.push(...getSafe(exerciseLibrary.mobility, 2));
                dailyRoutine.push(...getSafe(exerciseLibrary.fundamental, 2));
            } 
            else if (appState.primaryGoal === "strength") {
                dailyRoutine.push(...getSafe(exerciseLibrary.strength, 3));
                dailyRoutine.push(...getSafe(exerciseLibrary.fundamental, 2));
                dailyRoutine.push(...getSafe(exerciseLibrary.endurance, 1));
            }
            else {
                // Fundamental / Beginner
                dailyRoutine.push(...getSafe(exerciseLibrary.fundamental, 3));
                dailyRoutine.push(...getSafe(exerciseLibrary.mobility, 1));
                dailyRoutine.push(...getSafe(exerciseLibrary.endurance, 1));
                dailyRoutine.push(...getSafe(exerciseLibrary.strength, 1));
            }
            
            appState.dayExercises[day] = shuffle(dailyRoutine).slice(0, 6);
            appState.dayProgress[day] = [];
        }
    }

    function getSafe(arr, count) {
        if (!arr) return [];
        return shuffle([...arr]).slice(0, count);
    }

    function showExercisePlan() {
        document.getElementById('quiz-section').classList.add('hidden');
        document.getElementById('analysis-section').classList.add('hidden');
        document.getElementById('progress-section').classList.add('hidden');
        document.getElementById('exercise-section').classList.remove('hidden');
        document.getElementById('floating-reset-btn').classList.remove('hidden');
        
        renderExerciseList();
        saveState();
    }

    function renderExerciseList() {
        const list = document.getElementById('exercise-list');
        list.innerHTML = '';
        
        const day = appState.currentDay;
        document.getElementById('current-day').textContent = day.toString().padStart(2, '0');
        
        const exercises = appState.dayExercises[day] || [];
        const completed = appState.dayProgress[day] || [];
        
        document.getElementById('completion-stats').textContent = `${completed.length}/${exercises.length} TASKS`;

        exercises.forEach((ex, idx) => {
            const isDone = completed.includes(ex.id);
            const isCurrent = idx === completed.length;
            const isLocked = idx > completed.length;

            const card = document.createElement('div');
            card.className = `exercise-card p-4 rounded-xl flex items-center gap-4 ${isLocked ? 'locked' : ''} ${isCurrent ? 'current' : ''} ${isDone ? 'completed' : ''} animate-fade-in group`;
            
            let iconColor = isDone ? 'bg-[#10b981] text-black' : (isLocked ? 'bg-white/10 text-white/30' : 'bg-[#FF5500] text-white');
            let icon = isDone ? '<i class="fas fa-check"></i>' : (isLocked ? '<i class="fas fa-lock"></i>' : idx + 1);

            card.innerHTML = `
                <div class="w-10 h-10 rounded-lg flex items-center justify-center font-bold font-mono-tech ${iconColor} transition-all shrink-0 shadow-lg">
                    ${icon}
                </div>
                <div class="flex-1 min-w-0">
                    <h4 class="text-sm font-bold text-white group-hover:text-[#FF5500] transition-colors truncate">${ex.name}</h4>
                    <p class="text-[9px] text-gray-400 uppercase font-mono-tech tracking-wider mt-1 truncate">
                        ${ex.category} <span class="text-[#FF5500]">•</span> ${ex.duration}
                    </p>
                </div>
                ${!isLocked && !isDone ? '<div class="w-8 h-8 rounded-full bg-white/5 flex items-center justify-center shrink-0 border border-white/10"><i class="fas fa-play text-[#FF5500] text-xs"></i></div>' : ''}
            `;
            
            if (!isLocked && !isDone) {
                card.onclick = () => openVideo(ex, idx);
                card.style.cursor = 'pointer';
            }
            list.appendChild(card);
        });
    }

    let activeEx = null;
    let videoCompleted = false;
    
    function openVideo(ex, idx) {
        activeEx = ex;
        videoCompleted = false;
        
        document.getElementById('video-title').textContent = ex.name;
        document.getElementById('video-description').textContent = ex.description;
        document.getElementById('video-duration').textContent = ex.duration;
        document.getElementById('video-reps').textContent = ex.reps;
        document.getElementById('video-category').textContent = ex.category;
        
        const frame = document.getElementById('video-frame');
        // YouTube embed
        frame.innerHTML = `
            <iframe 
                id="youtube-player"
                src="https://www.youtube.com/embed/${ex.videoCode}?enablejsapi=1&rel=0&modestbranding=1&playsinline=1&controls=0" 
                class="absolute top-0 left-0 w-full h-full object-cover"
                frameborder="0" 
                allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture" 
                allowfullscreen>
            </iframe>`;
        
        document.getElementById('video-progress-fill').style.width = '0%';
        document.getElementById('video-time-current').textContent = '0:00';
        document.getElementById('video-time-total').textContent = '0:00';
        
        const completeBtn = document.getElementById('complete-btn');
        completeBtn.disabled = true;
        document.getElementById('complete-btn-text').textContent = 'PROTOCOL IN PROGRESS...';
        document.getElementById('video-loading').classList.remove('hidden');
        
        document.getElementById('video-modal').classList.remove('hidden');
        
        if (!window.YT) {
            const tag = document.createElement('script');
            tag.src = "https://www.youtube.com/iframe_api";
            const firstScriptTag = document.getElementsByTagName('script')[0];
            firstScriptTag.parentNode.insertBefore(tag, firstScriptTag);
        } else if (window.YT && YT.Player) {
            createPlayer();
        }
        
        if (videoCheckInterval) clearInterval(videoCheckInterval);
        videoCheckInterval = setInterval(checkVideoProgress, 1000);
    }

    function createPlayer() {
        youtubePlayer = new YT.Player('youtube-player', {
            events: { 'onReady': onPlayerReady, 'onStateChange': onPlayerStateChange }
        });
    }

    window.onYouTubeIframeAPIReady = function() {
        if(!document.getElementById('video-modal').classList.contains('hidden')) createPlayer();
    };

    function onPlayerReady(event) {
        document.getElementById('video-loading').classList.add('hidden');
        const duration = event.target.getDuration();
        updateTimeDisplay(duration, 'video-time-total');
    }

    function onPlayerStateChange(event) {
        if (event.data === YT.PlayerState.ENDED) {
            videoCompleted = true;
            enableCompleteButton();
        }
    }

    function checkVideoProgress() {
        if (youtubePlayer && youtubePlayer.getCurrentTime && youtubePlayer.getDuration) {
            const currentTime = youtubePlayer.getCurrentTime();
            const duration = youtubePlayer.getDuration();
            if (duration > 0) {
                const progressPercent = (currentTime / duration) * 100;
                document.getElementById('video-progress-fill').style.width = `${progressPercent}%`;
                updateTimeDisplay(currentTime, 'video-time-current');
                if (progressPercent >= 90 && !videoCompleted) {
                    videoCompleted = true;
                    enableCompleteButton();
                }
            }
        }
    }

    function updateTimeDisplay(time, elementId) {
        const minutes = Math.floor(time / 60);
        const seconds = Math.floor(time % 60);
        document.getElementById(elementId).textContent = `${minutes}:${seconds.toString().padStart(2, '0')}`;
    }

    function enableCompleteButton() {
        const completeBtn = document.getElementById('complete-btn');
        completeBtn.disabled = false;
        document.getElementById('complete-btn-text').textContent = 'COMPLETE & SYNC DATA';
        document.getElementById('video-progress-fill').style.width = '100%';
    }

    function markCurrentExerciseComplete() {
        if (!activeEx || !videoCompleted) return;
        
        const day = appState.currentDay;
        if (!appState.dayProgress[day].includes(activeEx.id)) {
            appState.dayProgress[day].push(activeEx.id);
        }

        if (appState.dayProgress[day].length === appState.dayExercises[day].length && day < 30) {
            appState.currentDay++;
        }

        closeVideoModal();
        renderExerciseList();
        saveState();
    }

    function closeVideoModal() {
        if (videoCheckInterval) clearInterval(videoCheckInterval);
        if (youtubePlayer && youtubePlayer.stopVideo) { try { youtubePlayer.stopVideo(); } catch(e){} youtubePlayer = null; }
        document.getElementById('video-modal').classList.add('hidden');
        document.getElementById('video-frame').innerHTML = '';
        activeEx = null; videoCompleted = false;
    }

    // === RESET SYSTEM FUNCTIONS ===
    function restartAssessment() {
        document.getElementById('custom-alert-modal').classList.remove('hidden');
    }
    function confirmReset() {
        localStorage.removeItem('STIPRO_CALISTHENICS_ORANGE_DATA');
        location.reload();
    }
    function cancelReset() {
        document.getElementById('custom-alert-modal').classList.add('hidden');
    }

    function shuffle(array) { 
        const shuffled = [...array];
        for (let i = shuffled.length - 1; i > 0; i--) {
            const j = Math.floor(Math.random() * (i + 1));
            [shuffled[i], shuffled[j]] = [shuffled[j], shuffled[i]];
        }
        return shuffled;
    }
    
    function animateScore(id, target) {
        let cur = 0;
        const el = document.getElementById(id);
        const iv = setInterval(() => {
            cur += 2;
            if (cur >= target) { el.textContent = target + '%'; clearInterval(iv); }
            else { el.textContent = cur + '%'; }
        }, 20);
    }

    window.onload = initApp;
</script>
</body>
</html>
